<!DOCTYPE html>
<html lang="en">
    <!-- Header information -->
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Polar3d</title>
        <link href="/css/bootstrap.min.css" media="screen" rel="stylesheet" type="text/css">
        <link href="/css/polar_ui.css" media="screen" rel="stylesheet" type="text/css">
        <link href="/img/PolarPCircle32x32.png" rel="shortcut icon" type="image/vnd.microsoft.icon">
        <link href="/bootstrap-select/css/bootstrap-select.min.css" rel="stylesheet">
    </head>
    <!-- Body section -->
    <body>
        <div class="pd-wrapper body">
            <div id="message" style="display:none;">Updating please wait...</div>
            <div class="pd-lhs-pnl">
                <div>
                    <a href="#">
                    <img src="img/polar3d-logo.png" class="hidden-xs"/>
                    <img src="img/PolarPCircle32x32.png" class="visible-xs logo"/>
                    </a>
                </div>
                <div class="pd-lhs-menu">
                    <ul>
<!-- Formatting tabs on left of local IP -->
                        <!-- Design Tab -->
                        <li id="lidesign">
                            <a id="tabdesign" href="#tabdesign" style="cursor:pointer;">
                                <span class="design"></span>
                                <div class="hidden-xs">Design File</div>
                            </a>
                        </li>
                        <!-- Print Tab -->
                        <li id="liprint">
                            <a id="tabprint" href="#tabprint" style="cursor:pointer;">
                                <span class="print"></span>
                                <div class="hidden-xs">Print File</div>
                            </a>
                        </li>
                        <!-- Print Tab -->
                        <li id="liprinter" style="display:none">
                            <a id="tabprinter" href="#tabprinter" style="cursor:pointer;">
                                <span class="print"></span>
                                <div class="hidden-xs">Printer</div>
                            </a>
                        </li>
                        <!-- Controls Tab -->
                        <li id="licontrols">
                            <a id="tabcontrols" href="#tabcontrols" style="cursor:pointer;">
                                <span class="controls"></span>
                                <div class="hidden-xs">Controls</div>
                            </a>
                        </li>
                        <!-- Calibrate Tab -->
                        <li id="licalibrate">
                            <a id="tabcalibration" href="#tabcalibration" style="cursor:pointer;">
                                <span class="calibration"></span>
                                <div class="hidden-xs">Calibration</div>
                            </a>
                        </li>
                        <!-- Camera Tab -->
                        <li id="licamera">
                            <a id="tabcamera" href="#tabcamera" style="cursor:pointer;">
                                <span class="camera"></span>
                                <div class="hidden-xs">Camera</div>
                            </a>
                        </li>
                        <!-- Network Tab -->
                        <li id="linetwork" class="active" style="cursor:pointer;">
                            <a id="tabnetwork" href="#tabnetwork">
                                <span class="network"></span>
                                <div class="hidden-xs">Network</div>
                            </a>
                        </li>
                        <!-- Update Tab -->
                        <li id="liupdate" style="display:none" >
                            <a id="tabupdate" style="cursor:pointer;">
                                <span class="update"></span>
                                <div class="hidden-xs">Update</div>
                            </a>
                        </li>
                        <!-- Restart Tab -->
                        <li>
                            <a id="tabrestart" style="cursor:pointer;">
                                <span class="restart"></span>
                                <div class="hidden-xs">Restart</div>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>

<!--===========================================================================================================================================-->
            <!-- Local IP Internal Interface -->
            <div class="pd-rhs-pnl">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="pd-inr-pnl">
                            <!-- Network Page Configuration -->
                            <div class="pd-table-pnl" id="divnetwork">
                                <div id="networkConfig" class="container">
                                       <ul class="nav nav-tabs">
                                   			<li><a  href="#ethernetTab" data-toggle="tab">Ethernet</a></li>
                                         <li class="active"><a href="#wifiTab" data-toggle="tab" id="existingNetworks">Existing WiFi</a></li>
                                         <li><a href="#addWifiTab" data-toggle="tab" id="wifiTabScan">Add WiFi</a></li>
                                   		</ul>
                                     			<div class="tab-content clearfix">
                                     			  <div class="tab-pane" id="ethernetTab">
                                               <div id="ethernet" class="span3">
                                                 <h2>Ethernet Settings</h2>
                                                 <div class="input-group">
                                                   <div class="btn-group radioBtns">
                                                     <a class="btn btn-default btn-sm active" data-toggle="ethernet-dhcp" data-title="DHCP">DHCP</a>
                                                     <a class="btn btn-default btn-sm notActive" data-toggle="ethernet-dhcp" data-title="STATIC">Static Address</a>
                                                   </div>
                                                   <input type="hidden" name="ethernet-dhcp" id="ethernet-dhcp" value="DHCP">
                                                 </div>

                                                 <div id="static-ethernet" class="form-horizontal collapse" class="form-horizontal">
                                                   <form id="ethernet-network">
                                                   <!-- Text input-->
                                                   <div class="form-group">
                                                     <div class="col-md-2">
                                                     <label class="control-label" for="ip">IP Address:</label>
                                                     <input id="ethernet-ip" name="ethernet-ip" type="text" class="form-control input-md" data-validation="ipaddress" data-validation-optional="false" >
                                                     </div>
                                                   </div>
                                                   <!-- Text input-->
                                                   <div class="form-group">
                                                     <div class="col-md-2">
                                                       <label class="control-label" for="mask">Network Mask:</label>
                                                     <input id="ethernet-mask" name="ethernet-mask" type="text" class="form-control input-md" data-validation="ipaddress" data-validation-optional="false" >
                                                     </div>
                                                   </div>
                                                   <!-- Text input-->
                                                   <div class="form-group">
                                                     <div class="col-md-2">
                                                       <label class="control-label" for="gateway">Gateway:</label>
                                                       <input id="ethernet-gateway" name="ethernet-gateway" type="text" class="form-control input-md" data-validation="ipaddress" data-validation-optional="false" >
                                                     </div>
                                                   </div>
                                                   <!-- Text input-->
                                                   <div class="form-group">
                                                     <div class="col-md-2">
                                                       <label class="control-label" for="ethernet-mask">DNS (Space separated):</label>
                                                     <input id="ethernet-dns" name="ethernet-dns" type="text" class="form-control input-md" data-validation="dns" data-validation-optional="false" >
                                                     </div>
                                                   </div>
                                                 </div>
                                               </div>
                                               <button type="submit" class="btn btn-default" aria-label="Left Align" id="saveEthernet">Save Settings</button>
                                             </form>
                                                   				</div>
                                     				<div class="tab-pane active" id="wifiTab">
                                            <h2>Configured Network</h2>
                                               <ul class="list-group" id="networkList">
                                               </ul>
                                               <!--<div>Drag networks into the preferred order.</div>-->

                                             </div>

                                             <div class="tab-pane" id="addWifiTab">
                                               <input class='btn btn-default btn-sm notActive' type='Button' id="scanNetwork" value='Scan Network'>
                                                 <div class="container" id="content">
                                                   <div id="WiFi" class="span3">
                                                     <h2>Add WiFi Network</h2>
                                                     <div class="col-lg-12">
                                                       <select id="networks" class="selectpicker" data-style="btn-default" style="display: none;" title="Select a Network...">
                                                         <option data-icon="glyphicon">Loading...</option>
                                                       </select><span id="loadingNetworks" class="loading">&nbsp;</span>
                                                     </div>
                                                     <div id="new-wifi" class="collapse">
                                                       <div id="hiddenNetworkDIV" style="form-group display:none">
                                                         <div class="col-md-4">
                                                           <label class="control-label" for="hiddenNetwork">Network Name:</label>
                                                         <input id="hiddenNetwork" name="hiddenNetwork" type="text" class="form-control input-md">
                                                         </div>
                                                       </div>
                                                       <div class="clearfix mar-b10"></div>
                                                       <div id="passwordDIV" style="form-group display:none">
                                                         <div class="col-md-4">
                                                           <label class="control-label" for="password">Password:</label>
                                                         <input id="wifi-password" name="wifi-password" type="password" class="form-control input-md"><br>
                                                         <input type="checkbox" id="showhide" class="togglePassword" data-toggle="wifi-password"><label for="showhide">&nbsp;Show Password</label>
                                                         </div>
                                                       </div>
                                                       <style>
                                                           #wrapper {
                                                               clear: both;
                                                               padding: 5px 50px;
                                                           }
                                                       </style>

                                                       <div id='wrapper'></div>

                                                       <div class="input-group">
                                                 				<div class="btn-group radioBtns">
                                                 					<a class="btn btn-default btn-sm active" data-toggle="wifi-dhcp" data-title="DHCP">DHCP</a>
                                                 					<a class="btn btn-default btn-sm notActive" data-toggle="wifi-dhcp" data-title="STATIC">Static Address</a>
                                                 				</div>
                                                 				<input type="hidden" name="wifi-dhcp" id="wifi-dhcp" value="DHCP">
                                                 			</div>

                                                       <div id="static-wifi" class="form-horizontal collapse" class="form-horizontal">
                                                         <form id="wifi-network">
                                                         <!-- Text input-->
                                                         <div class="form-group">
                                                           <div class="col-md-2">
                                                           <label class="control-label" for="wifi-ip">IP Address:</label>
                                                           <input id="wifi-ip" name="wifi-ip" type="text" class="form-control input-md" data-validation="ipaddress" data-validation-optional="false" >
                                                           </div>
                                                         </div>
                                                         <!-- Text input-->
                                                         <div class="form-group">
                                                           <div class="col-md-2">
                                                             <label class="control-label" for="wifi-mask">Network Mask:</label>
                                                           <input id="wifi-mask" name="wifi-mask" type="text" class="form-control input-md" data-validation="ipaddress" data-validation-optional="false" >
                                                           </div>
                                                         </div>
                                                         <!-- Text input-->
                                                         <div class="form-group">
                                                           <div class="col-md-2">
                                                             <label class="control-label" for="wifi-gateway">Gateway:</label>
                                                             <input id="wifi-gateway" name="wifi-gateway" type="text" class="form-control input-md" data-validation="ipaddress" data-validation-optional="false" >
                                                           </div>
                                                         </div>
                                                         <!-- Text input-->
                                                         <div class="form-group">
                                                           <div class="col-md-2">
                                                             <label class="control-label" for="wifi-dns">DNS (Space separated):</label>
                                                           <input id="wifi-dns" name="wifi-dns" type="text" class="form-control input-md" data-validation="dns" data-validation-optional="false" >
                                                           </div>
                                                         </div>
                                                       </div>
                                                       <button type="submit" class="btn btn-default" aria-label="Left Align" id="addNetwork">Add Network</button>
                                                     </form>
                                                     </div>
                                                   </div>
                                               </div>
                                     			</div>
                                       </div>

                                       <div class="clearfix mar-b20"></div>
                                       <div style="border:1px solid Gainsboro;">
                                        <div style="padding-left:20px; padding-top:10px">
                                        <h5 class="pd-mnlcntrl-hdg">Network Information</h5>
                                            <div>
                                                <span id="ipAddr">IP Address ::</span><br />
                                                <span id="wlan0netmask">Subnet ::</span><br />
                                                <span id="wlan0Mac">Current Mac ::</span><br />
                                            </div>
                                           <h5 class="pd-mnlcntrl-hdg bdr-top">Reset Networks</h5>
                                           <div class="pd-btn-box">
                                               <div class="btn-group">
                                                   <a class="btn pd-btn-blue" href="#"  id="resetNetworks">Reset Networks</a>
                                               </div>
                                           </div>
                                          <h5 class="pd-mnlcntrl-hdg bdr-top">Reset Printer</h5>
                                           <div class="pd-btn-box">
                                               <div class="btn-group">
                                                   <a class="btn pd-btn-blue" href="#tabNetwork"  id="resetPrinter">Reset Printer on the Polar Cloud</a>
                                               </div>
                                           </div>
                                       </div>
                                       </div>
                                       </div>

                                     <div class="hideClick bb-alert alert alert-info" style="display:none;">
                                         <span>The examples populate this alert with dummy content</span>
                                     </div>
                            </div>
<!--===========================================================================================================================================-->
                            <!-- Print Page Configuration -->
                            <div class="pd-table-pnl" id="divprint" style="display:none; min-width: 800px;">
                                <h3 class="pd-inr-hdg">Project Details</h3>
                                <div style="float:left; width: 30%">
                                <form id="PrintFile">
                                    <h5 class="pd-mnlcntrl-hdg">Print File</h5>
                                    <div class="clearfix mar-b10"></div>
                                    <select class="form-control selectpicker mar-b10 w230" id="fileName">
                                    </select>
                                    <div id='hideConfig'>
                                        <h5 class="pd-mnlcntrl-hdg">Print Configuration</h5>
                                        <select class="form-control selectpicker w230" id="configFile">
                                            <option value="/files/config/320radius.cfg">320 Radius</option>
                                            <option value="/files/config/200radius.cfg">200 Radius</option>
                                            <option value="/files/config/320center.cfg">320 Center</option>
                                            <option value="/files/config/200center.cfg">200 Center</option>
                                        </select>
                                    </div>
                                    <div class="clearfix mar-b20"></div>
                                    <button type="submit" id="btnPrintFile" value="" class="btn pd-btn-blue mar-l0 mar-b10">Print File</button>
                                </form>
                                <div class="pd-btn-box">
                                    <div class="btn-group">
                                        <a class="btn pd-btn-blue" href="#"  id="deleteFile">Delete Selected File</a>
                                    </div>
                                </div>
                                <h5 class="pd-mnlcntrl-hdg">Upload file</h5>
                                <form id="UploadStl" enctype="multipart/form-data" action="/uploadStl" method="post">
                                    <input type="file" id="stlFile"  name="stlFile" class="pd-input-file" />
                                    <button type="submit" value="" class="btn pd-btn-blue mar-l0 mar-b10">Upload File</button>
                                </form>
                                <div class="clearfix"></div>
                                </div>
                                <div style="float:right; width: 70%">
                                <h5 class="pd-mnlcntrl-hdg">Printer Status</h5>
                                <textarea id="status" style="height: 350px;" class="form-control min-h120">Printer Status...</textarea>
                                </div>
                            <div style="clear:both"></div>
                            <p>
                            <pre id="sliceStatus"></pre>
                            </p>
                            </div>
<!--===========================================================================================================================================-->
                            <!-- Printer Page Configuration -->
                            <div class="pd-table-pnl" id="divprinter" style="display:none; min-width: 800px;">
                                <h3 class="pd-inr-hdg">Polar Box Details</h3>
                                <div id='setPrinterType' style="display:none;">
                                    <h5 class="pd-mnlcntrl-hdg">Current Printer Type</h5>
                                    <p>Printer currently set to: <span id="currentPrinterType"></p>
                                    <div class="clearfix"></div>
                                    <h5 class="pd-mnlcntrl-hdg">Set Printer Type</h5>
                                    <div class="clearfix mar-b10"></div>
                                    <select class="form-control selectpicker mar-b10 w230" id="printerTypes">
                                    </select>
                                    <div class="clearfix"></div>
                                    <button type="submit" id="btnSetPrinterType" value="" class="btn pd-btn-blue mar-l0 mar-b10">Set Printer Type</button>
                                    <h5 class="pd-mnlcntrl-hdg">Printer Status</h5>
                                    <div class="clearfix"></div>
                                    <textarea style="height: 350px;" class="form-control min-h120" id="statusPrinterPage" disabled></textarea>
                                    <div class="clearfix"></div>
                                    <p>
                                    <pre id="sliceStatusPrinterPage"></pre>
                                    </p>
                                    </div>
                            </div>
<!--===========================================================================================================================================-->
                            <!-- Calibration Page Configuration -->
                            <div class="pd-table-pnl" id="divcalibrate" style="display:none;">
                                <h3 class="pd-inr-hdg">Printer Calibration</h3>
                                <h5 class="pd-mnlcntrl-hdg">Z Axis Calibration Adjustment</h5>
                                <div class="pd-btn-box">
                                    <div class="btn-group">
                                        <a target="#" id="zOffsetUp" class="btn pd-btn-blue">Z Offset Up</a>
                                        <a target="#" id="zOffsetDown" class="btn pd-btn-blue">Z Offset Down</a>
                                    </div>
                                </div>
                                <div class="pd-btn-box">
                                    <div class="btn-group">
                                        <a class="btn pd-btn-blue" href="#"  id="adjustmentInfoZ">About Z Axis Offset Adjustment</a>
                                    </div>
                                </div>
                                <h5 class="pd-mnlcntrl-hdg bdr-top">X Axis Calibration</h5>
                                <div class="pd-btn-box">
                                    <div class="btn-group">
                                        <a class="btn pd-btn-blue" href="#"  id="xcalibration">Start X Calibration</a>
                                    </div>
                                </div>
                                <h5 class="pd-mnlcntrl-hdg">X Axis Calibration Adjustment</h5>
                                <div class="pd-btn-box">
                                    <div class="btn-group">
                                        <a target="#" id="xOffsetForward" class="btn pd-btn-blue">X Offset Forward</a>
                                        <a target="#" id="xOffsetBackward" class="btn pd-btn-blue">X Offset Backward</a>
                                    </div>
                                </div>
                                <div class="pd-btn-box">
                                    <div class="btn-group">
                                        <a class="btn pd-btn-blue" href="#"  id="adjustmentInfoX">About X Offset Adjustment</a>
                                    </div>
                                </div>
                            </div>
<!--===========================================================================================================================================-->
                            <!-- Manual Controls Page Configuration -->
                            <div class="pd-table-pnl" id="divcontrols" style="display:none; min-width: 650px;">
                                <h3 class="pd-inr-hdg">Manual Printer Controls</h3>
                                <div style="float:left; width: 30%">
                                <h5 class="pd-mnlcntrl-hdg" id="jobControls">Job Controls</h5>
                                <div class="pd-btn-box" id="pauseKillHide">
                                    <div class="btn-group">
                                        <a target="#" id="pauseResume" class="btn pd-btn-blue w115">Pause</a>
                                        <a target="#" id="killJob" class="btn pd-btn-blue w115">Kill Job</a>
                                    </div>
                                </div>
                                <div class="pd-btn-box" id="coldPauseHide">
                                    <div class="btn-group">
                                        <a class="btn pd-btn-blue" href="#"  id="coldPause">Cold Pause</a>
                                    </div>
                                </div>
                                <div class="pd-btn-box" id="changeFilamentHide">
                                    <div class="btn-group">
                                        <a class="btn pd-btn-blue" href="#"  id="changeFilament">Change Filament</a>
                                    </div>
                                </div>
                                <h5 class="pd-mnlcntrl-hdg">Raise Print Head</h5>
                                <div class="pd-btn-box">
                                    <div class="btn-group">
                                        <a class="btn pd-btn-blue w115" href="#" id="zAxisUp"><span class="pd-icon-up-arrow"></span></a>
                                    </div>
                                </div>
                                <h5 class="pd-mnlcntrl-hdg">Extrusion Controls</h5>
                                <div class="pd-btn-box">
                                    <div class="btn-group">
                                        <a class="btn pd-btn-blue" href="#"  id="extrude">Extrude 1mm</a>
                                    </div>
                                </div>
                                <h5 class="pd-mnlcntrl-hdg">Home and Center the Print Plater</h5>
                                <div class="pd-btn-box">
                                    <div class="btn-group">
                                        <a class="btn pd-btn-blue" href="#"  id="home">Home and Center</a>
                                    </div>
                                </div>
                                <h5 class="pd-mnlcntrl-hdg">Unlock Stepper Motors</h5>
                                <div class="btn-group">
                                    <a class="btn pd-btn-blue" href="#"  id="unlockMotors">Unlock Motors</a>
                                </div>
                                <div class="clearfix mar-b20"></div>
                                <div id='hidePolarLights'>
                                <h5 class="pd-mnlcntrl-hdg">Turn Off Polar3D Lights</h5>
                                <div class="btn-group">
                                    <a class="btn pd-btn-blue" href="#"  id="lightsOff">Lights Off</a>
                                </div>
                              </div>
                              </div>
                                <div style="float:right; width: 70%;">
                                <h5 class="pd-mnlcntrl-hdg">Set Temperature</h5>
                                <div class="input-group col-lg-4 col-md-5 col-sm-8 col-xs-12 mar-b20">
                                    <input type="number" value="" placeholder="Enter A Temperature" class="form-control" id='t'>
                                    <span class="input-group-btn"><button type="submit" class="btn pd-btn-blue btn-code" id="tempCmdSend" style="padding:0px">Set</button></span>
                                </div>
                                <p>Temperature is currently <span id="temperature">0</span><sup>o</sup>C</p>
                                <div class="pd-btn-box">
                                    <div class="btn-group">
                                        <a class="btn pd-btn-blue" href="#"  id="killHeater">Turn off Hotend</a>
                                    </div>
                                </div>
                                <h5 class="pd-mnlcntrl-hdg bdr-top">Send GCode</h5>
                                <div class="input-group col-lg-4 col-md-5 col-sm-8 col-xs-12 mar-b20">
                                    <input type="text" value="" placeholder="Enter A Command" class="form-control" id='m'>
                                    <span class="input-group-btn"><button type="submit" class="btn pd-btn-blue btn-code" id="cmdSend" style="padding:0px">Send</button></span>
                                </div>
                                <h5 class="pd-mnlcntrl-hdg">GCode Response</h5>
                                <textarea style="height: 150px;" class="form-control min-h120" id="cmdResponse" disabled></textarea>
                                </div>
                                <div style="clear:both"></div>
                            </div>
<!--===========================================================================================================================================-->
                            <!-- Camera Page Configuration -->
                            <div class="pd-table-pnl" id="divcamera" style="display:none;">
                                <h3 class="pd-inr-hdg">Live Camera View</h3>
                                <div style="float:left; width: 55%;">
                                <div class="pd-camera-image">
                                    <img id="vidSource" src="img/camera-image.jpg"  class="img-responsive x-rotated-180"/>
                                </div>
                                </div>
                                <div style="float:right; width: 45%; padding-left: 20px">
                                    <h5 class="pd-mnlcntrl-hdg">Printer Status</h5>
                                    <textarea style="height: 350px;" class="form-control min-h120" id="statusCamPage" disabled></textarea>
                                </div>
                                <div style="clear:both"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
<!--===========================================================================================================================================-->
            <!-- End of page formatting -->
            <div class="pd-footer">
                <div class="pull-left" id="divserialnumber"></div>
                <div class="pull-right" id="divversionnumber"></div>
            </div>
        </div>

        <div id="myModal" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h5 class="modal-title"><strong>Polar3D</strong></h5>
                    </div>
                    <div class="modal-body">
                        <p id="statusMessage"></p>
                        <br/>
                    </div>
                    <div class="modal-footer">
                        <div class="to-buttons1">
                            <div class="cancel" data-dismiss="modal"><button value="SUBMIT" class="pd-btn-blue" >OK</button></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
<!--===========================================================================================================================================-->
        <!-- Custom Modal Configurations -->
        <!-- Confirmation Modal  -->
        <div id="myModalConfirm" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h5 class="modal-title"><strong>Polar3D</strong></h5>
                    </div>
                    <div class="modal-body">
                        <p id="statusMessageConfirm"></p>
                        <br/>
                        <input type="hidden" id="hidConfirm" />
                    </div>
                    <div class="modal-footer">
                        <div class="to-buttons1">
                            <div class="cancel" data-dismiss="modal"><button value="SUBMIT" class="pd-btn-blue">Cancel</button></div>
                            <div class="submit" data-dismiss="modal"><button value="SUBMIT" class="pd-btn-blue" id="btnConfirm">Confirm</button></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
<!--===========================================================================================================================================-->
        <!-- Forget Networks Modal  -->
        <div id="forgetNetworksModal" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h5 class="modal-title"><strong>Polar3D</strong></h5>
                    </div>
                    <div class="modal-body">
                        <p id="deleteFileMessage">Do you wish to delete all known networks and restore network settings? Reboot will be automatic.</p>
                        <br/>
                    </div>
                    <div class="modal-footer">
                        <div class="to-buttons1">
                            <div class="cancel" data-dismiss="modal"><button  class="pd-btn-blue" id="forgetNetworksCancel">Cancel</button></div>
                            <div class="cancel" data-dismiss="none"><button value="SUBMIT" class="pd-btn-blue" id="forgetNetworksOK" >Reset Networks</button></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
<!--===========================================================================================================================================-->
        <!-- Delete File Modal  -->
        <div id="deleteFileConfirm" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h5 class="modal-title"><strong>Polar3D</strong></h5>
                    </div>
                    <div class="modal-body">
                        <p id="deleteFileMessage2">Do you wish to delete the selected file?</p>
                        <br/>
                    </div>
                    <div class="modal-footer">
                        <div class="to-buttons1">
                            <div class="cancel" data-dismiss="modal"><button  class="pd-btn-blue" id="deleteFileCancel">Cancel</button></div>
                            <div class="cancel" data-dismiss="none"><button value="SUBMIT" class="pd-btn-blue" id="deleteFileOK" >Delete File</button></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
<!--===========================================================================================================================================-->
        <div id="calibrationModal" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h5 class="modal-title"><strong>Polar3D</strong></h5>
                    </div>
                    <div class="modal-body">
                        <p id="calibrationModalMessage">Select which calibration to begin</p>
                        <br/>
                        <input type="hidden" id="hidCalibration" />
                    </div>
                    <div class="modal-footer">
                        <div class="to-buttons1">
                            <div class="cancel" data-dismiss="modal"><button  class="pd-btn-blue" id="btnCalCalncel">Exit</button></div>
                            <div class="cancel" data-dismiss="modal"><button  class="pd-btn-blue" id="btnzcal">Start Z Cal</button></div>
                            <div class="cancel" data-dismiss="modal"><button  class="pd-btn-blue" id="btnxcal">Start X Cal</button></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
<!--===========================================================================================================================================-->
        <!-- BEGIN JAVSCRIPT SECTION -->
        <script src="/js/modernizr.custom.63321.js"></script>
        <script src="/js/jquery-1.11.1.js"></script>
        <script src="/js/jquery-ui.js"></script>
        <script src="/jquery/jquery.min.js"></script>
        <script src="/js/jquery.blockUI.js"></script>
        <script src="/js/bootstrap.min.js"></script>
        <script src="/bootstrap-select/js/bootstrap-select.min.js"></script>
        <script src="/socket.io/socket.io.js"></script>
        <script src="/form-validator/jquery.form-validator.min.js"></script>
        <script src="/socket.io/socket.io.js"></script>
        <script src="/js/network.js"></script>
        <script src="/js/bootbox.min.js"></script>
        <script src="/js/Sortable.min.js"></script>
        <script>
// Global variable declaration
var socket = io();
var controlIterator = 1;
// Calibration variables
var dist;
var modVal;
var count;
// Variables to handle cold pause logig
var temperature;
var status;
$(".add-more").click(function() {
    controlIterator = controlIterator + 1;
    $('#controlsadvancedconfig').append(' <div class="form-inline mar-b15" id="divcontrols' + controlIterator + '"> <div class="form-group"><div class="controls"> <input type="text" class="form-control" id="inputkey' + controlIterator + '" placeholder="key" />&nbsp;<input type="text" class="form-control" id="inputvalue' + controlIterator + '" placeholder="value" />&nbsp;<button id="remove' + controlIterator + '" class="btn pd-btn-blue btn-new2" onclick="deleteControls(' + controlIterator + ')" > X </button></div></div></div>');
});
function deleteControls(fieldNum) {
    var fieldID = "#divcontrols" + fieldNum;
    $(fieldID).remove();
}

$(document).ready(function(){
    $('#fileName').on('change', function() {
        // Check if it is a gcode file
        if ( this.value.indexOf('.gcode') > -1) {
        $("#hideConfig").hide();
        }
        else {
        $("#hideConfig").show();
        }
    });
});

// Listens to see if we need to not flip the image
socket.on('newCam', function() {
    $('#vidSource').removeClass('img-responsive x-rotated-180');
    $('#vidSource').addClass('img-responsive');
});

// Displays release notes
socket.on('releaseNotes', function(notes) {
    $('#statusMessageConfirm').html("Do you wish to update the printer? <br/><br/>" + notes);
    $('#myModalConfirm').modal('show');
    $('#hidConfirm').val('2');
});

// Displays calibration modal
socket.on('calibration', function() {
    $('#calibrationModal').modal('show');
});

function BlockUI() {
    $('.body').block({
        message: $('#message'),
        centerX: true,
        centerY: true,
        css: {
            background: 'transparent',
            border: 'none',
            color: 'white'
        }
    });
}
function UnBlockUI() {
    $('.body').unblock();
}
//====================================================================================================================
// Send gcode in text box on button press
$('#gCodeCmd').submit(function(event) {
    socket.emit('chat message', $('#m').val());
    $('#m').val('');
    event.preventDefault();
    return false;
});
// Send command to unlock all motors
$('#unlockMotors').click(function(event) {
    unlockMotors();
    event.preventDefault();
});

$('#lightsOff').click(function(event) {
    socket.emit('lightsOff');
    event.preventDefault();
});

// Moves Z axis up 10 mm
$('#zAxisUp').click(function(event) {
    socket.emit('zAxisUp');
    event.preventDefault();
});
// Extrude 1 mm on button press
$('#extrude').click(function(event) {
    relativeMode();
    socket.emit('gCode', 'G0 E1 F300');
    absoluteMode();
    event.preventDefault();
});
// Turn off the hot end
$('#killHeater').click(function(event) {
    socket.emit('gCode', 'M104 S0\nM107');
    event.preventDefault();
});
// Home and center the button
$('#home').click(function(event) {
    socket.emit('homeAndCenter');
    event.preventDefault();
});

// Start Z cal
$('#btnzcal').click(function(event) {
    socket.emit('zcal');
    event.preventDefault();
});

// Start Z cal
$('#btnxcal').click(function(event) {
    socket.emit('xcal');
    event.preventDefault();
});

//====================================================================================================================
// Standard double home
function homeSequence() {
    socket.emit('gCode', 'G28');
    socket.emit('gCode', 'G29');
}
// Homes twice and goes to center
function homeSequenceAndZero() {
    socket.emit('gCode', 'G28');
    socket.emit('gCode', 'G29');
    socket.emit('gCode', 'G0 X0 Z0 F1500');
}
// Saves z offset value to eeprom
function setZHome(val) {
    socket.emit('gCode', 'M206 Z' + val);
    socket.emit('gCode', 'M500');
}
// Saves x offset value to eeprom
function setXHome(val) {
    socket.emit('gCode', 'M206 X' + val);
    socket.emit('gCode', 'M500');
}
// Moves z axis a specified distance
function moveZAxis(distance) {
    socket.emit('gCode', 'G0 Z' + distance);
}
// Moves x axis a specified distance
function moveXAxis(distance) {
    socket.emit('gCode', 'G0 X' + distance + 'F300');
}
// Moves Z axis up
function moveZUp(dist) {
    socket.emit('gCode', 'G0 Z' + dist + 'F300');
}
// Kills calibration cycle; moves z up and unlocks motors
function cancelCalibration() {
    moveZUp(30);
    unlockMotors();
}
// Absolute coordinates
function absoluteMode() {
    socket.emit('gCode', 'G90');
}
// Relative Coordinates
function relativeMode() {
    socket.emit('gCode', 'G91');
}
// Unlocks motor with M84 command
function unlockMotors() {
    socket.emit('gCode', 'M84');
}
// Homes x axis only
function homeXAxis() {
    socket.emit('gCode', 'G28 X');
}
//====================================================================================================================
// Calibration Interface Revamp
function sendM501() {
    // Send M501 to get eeprom values
    socket.emit('gCode', 'M501');
}
// Prints specified file at specified configuration; assumes default directories
// Do we want the file name to be a file path so we can put stl files other places?
function startJob(file, configName) {
    var jobInfo = {};
    jobInfo.job_id = '123';
    // Sets config file
    var config = '/files/config/' + configName;
    jobInfo.config_file = 'http://127.0.0.1' + config;
    // Sets file name
    var fileStr = file;
    jobInfo.stl_file = 'http://' + location.host + '/files/stl/' + fileStr;
    jobInfo.file_name = fileStr;
    jobInfo.isLocal = 1;
    socket.emit('printFile', jobInfo);
}
// Brings up modal for deleting an STL file
$('#deleteFile').click(function(event) {
    // Make sure a file is selected
    if ($("#fileName").val() == '') {
        $('#statusMessage').html('You must select an stl file for deletion.');
        $('#myModal').modal('show');
    }
    else {
        $('#deleteFileConfirm').modal('show');
    }
    event.preventDefault();
});
// Delete the selected file when confirmation pressed
$('#deleteFileOK').click(function(event) {
    $('#deleteFileConfirm').modal('hide');
        // Pull in the file from drop down list
        var file = $("#fileName").val();
        // Run the delete file script, pass in name of file
        socket.emit('deleteFile', file);
        // Bring us back to the right page
        location.reload();
        window.location.href = '/#tabprint';
});

// About adjustment functionality button press for Z axis
$('#adjustmentInfoZ').click(function(event) {
    $('#statusMessage').html('Z axis calibration adjustment will adjust the home offset by .05mm. Use this feature to make small adjustments to your printer\'s calibration.');
    $('#myModal').modal('show');
    event.preventDefault();
});
// About adjustment functionality button press for Z axis
$('#adjustmentInfoX').click(function(event) {
    $('#statusMessage').html('X axis calibration adjustment will adjust the home offset by .05mm. Use this feature to make small adjustments to your printer\'s calibration.');
    $('#myModal').modal('show');
    event.preventDefault();
});

var homeOffset;
// Adjusts Z offset value by .05 by pulling in user specified adjustment value
$('#zOffsetUp').click(function(event) {
    var offset = -.05;
    // Originial home value pulled from eeprom
    // Clear the cmdResponse Variable
    cmdResponse = '';
    tries = 1;
    sendM501();
    // Show error message if maximum connection attemps reached
    getHomeOffset();
    setTimeout(function() {
        if(homeOffset == -1 || isNaN(homeOffset[1])) {
            $('#statusMessage').html('Printer failed to adjust calibration value. Try again.');
            $('#myModal').modal('show');
        }
        else {
            val = homeOffset[1];
            // Change offset by the pulled home value so we apply the adjustment, then save it
            offset = offset + val;
            setZHome(offset);
            $('#statusMessage').html('Z calibration successfully adjusted to: ' +  offset.toFixed(2) + 'mm');
            $('#myModal').modal('show');
            //homeSequenceAndZero();
        }
    }, 310);
    event.preventDefault();
});
// Adjusts Z offset value by -.05 by pulling in user specified adjustment value
$('#zOffsetDown').click(function(event) {
    var offset = .05;
    // Originial home value pulled from eeprom
    cmdResponse = '';
    tries = 1;
    sendM501();
    getHomeOffset();
    // Show error message if maximum connection attemps reached
    setTimeout(function() {
        if(homeOffset == -1 || isNaN(homeOffset[0])) {
            $('#statusMessage').html('Printer failed to adjust calibration value. Try again.');
            $('#myModal').modal('show');
        }
        else {
            val = homeOffset[1];
            // Change offset by the pulled home value so we apply the adjustment, then save it
            offset = offset + val;
            setZHome(offset);
            $('#statusMessage').html('Z calibration successfully adjusted to: ' + offset.toFixed(2) + 'mm');
            $('#myModal').modal('show');
            //homeSequenceAndZero();
        }
    }, 310);
    event.preventDefault();
});
// Adjusts X offset value by pulling in user specified adjustent value
$('#xOffsetForward').click(function(event) {
    var offset = -0.05
    // Originial home value pulled from eeprom
    // Clear the cmdResponse Variable
    cmdResponse = '';
    tries = 1;
    sendM501();
    getHomeOffset();
    // Show error message if maximum connection attemps reached
    setTimeout(function() {
        if(homeOffset == -1 || isNaN(homeOffset[0])) {
            $('#statusMessage').html('Printer failed to adjust calibration value. Try again.');
            $('#myModal').modal('show');
        }
        else {
            val = homeOffset[0];
            // Change offset by the pulled home value so we apply the adjustment, then save it
            offset = offset + val;
            setXHome(offset);
            $('#statusMessage').html('X calibration successfully adjusted to: ' + offset.toFixed(2) + 'mm');
            $('#myModal').modal('show');
            //homeSequenceAndZero();
        }
    }, 310);
    event.preventDefault();
});
// Adjusts X offset value by pulling in user specified adjustent value
$('#xOffsetBackward').click(function(event) {
    var offset = 0.05
    // Originial home value pulled from eeprom
    // Clear the cmdResponse Variable
    cmdResponse = '';
    tries = 1;
    sendM501();
    getHomeOffset();
    // Show error message if maximum connection attemps reached
    setTimeout(function() {
        if(homeOffset == -1 || isNaN(homeOffset[0])) {
            $('#statusMessage').html('Printer failed to adjust calibration value. Try again.');
            $('#myModal').modal('show');
        }
        else {
            val = homeOffset[0];
            // Change offset by the pulled home value so we apply the adjustment, then save it
            offset = offset + val;
            setXHome(offset);
            $('#statusMessage').html('X calibration successfully adjusted to: ' + offset.toFixed(2) + 'mm');
            $('#myModal').modal('show');
            //homeSequenceAndZero();
        }
    }, 310);
    event.preventDefault();
});

//====================================================================================================================
// Start X calibration button
$('#startX').click(function(event) {
    $('#myModalStartX').modal('hide');
    socket.emit('gCode', 'G92 Z0');
    // Set M206 X Value to 0
    socket.emit('gCode', 'G28 X');
    relativeMode();
    moveXAxis(4);
    absoluteMode();
    modVal = 1;
    dist = -4;
    socket.emit('gCode', 'G92 Z30');
    moveZUp(0)
    $('#statusMessageXCalibration').html('Press the Too Far Back button to indicate the extruder nozzle is too far back with respect to the center of the build plate (there is a indentation in the center of the bolt at this point).');
    $('#myModalXCalibration').modal('show');
    event.preventDefault();
});
// X calibration confirmation dialogue
$('#xcalibration').click(function(event) {
    $('#startXMessage').html('Press OK to begin calibration. Be sure the build plate is on. Once the printer is done homing, remove the build plate and press OK.');
    $('#myModalStartX').modal('show');
    // Home Z
    socket.emit('gCode', 'G28 Z');
    // Move z up
    moveZUp(30);
    event.preventDefault();
});
// Kill calibration sequence
$('#btnCancelCalibrationX').click(function(event) {
    cancelCalibration();
    event.preventDefault();
});
// Nozzle is too far back
$('#btnLowX').click(function(event) {
    $('#statusMessageXCalibration').html('When the center of the bearing is even with or past the nozzle, you can then switch between Too Far Forward and Too Far Back to zero in on the right position.');
    dist = dist + modVal;
    relativeMode();
    moveXAxis(-modVal);
    absoluteMode();
    event.preventDefault();
});
// Nozzle is too far forward
$('#btnHighX').click(function(event) {
        modVal = modVal / 1.5;
        dist = dist - modVal;
        homeXAxis();
        moveZUp(0);
        relativeMode();
        moveXAxis(-dist);
        absoluteMode();
        event.preventDefault();
});
// X calibration finished
$('#btnJustRightX').click(function(event) {
    setXHome(dist);
    homeXAxis();
    socket.emit('gCode', 'G0 X0');
    unlockMotors();
    $('#statusMessage').html('X axis calibration complete. Your printer will now home and zero for you to validate that the X axis is calibrated properly. If it is still not right, begin the X calibration process again.');
    $('#myModal').modal('show');
    event.preventDefault();
});
//====================================================================================================================
// Ends print job
$('#killJob').click(function(event) {
    socket.emit('killJob');
    event.preventDefault();
});
// Cold pause button press
$('#coldPause').on('click', function() {
    if ($('#coldPause').html() == 'Cold Pause') {
        $('#statusMessage').html('The printer will pause and power off the extruder. Click Resume from Cold Pause when you wish to heat the extruder again and resume.');
        $('#myModal').modal('show');
        socket.emit('coldPause');
    }
    else {
        socket.emit('resumeJob');
    }
});
// Change filament
$('#changeFilament').on('click', function() {
    if ($('#changeFilament').html() == 'Change Filament') {
        $('#statusMessage').html('The printer will pause and back the filament out. When it is finished, remove the filament, push the new filament in (until it is at the bottom of the nozzle), and then press resume');
        $('#myModal').modal('show');
        socket.emit('changeFilament');
    }
    else {
        socket.emit('resumeJob');
    }
});
// Normal pause and resume
$('#pauseResume').on('click', function() {
    if ($('#pauseResume').html() == 'Pause') {
        socket.emit('pauseJob');
    }
    else {
        socket.emit('resumeJob');
    }
});
// Delete all known networks modal popup
$('#resetNetworks').click(function() {
    $('#forgetNetworksModal').modal('show');
});
// Forget networks confirmation button
$('#forgetNetworksOK').click(function() {
    $('#forgetNetworksModal').modal('hide');
    socket.emit('resetNetworks');
});
// Snapshots
$('#snapshot').click(function() {
    changeSource('snapshot');
});
// Streaming
$('#stream').click(function() {
    changeSource('stream');
});
// Need to populate global variable with printer response
var cmdResponse;
// Number of tries it tries to read the cmd response
var tries;
// Function to send M501 command and find home offset values recursively
function getHomeOffset() {
    // Check every 1 second to see if cmd response goes through
    setTimeout(function() {
        if(cmdResponse != '') {
            // Split printer response into array line by line
            var lines = cmdResponse.split('\n');
            // Pull home offset line for parsing
            var line; // Line for home offset vals
            for (i = 0; i < lines.length; i++) {
                if(lines[i].indexOf('M206') > -1) {
                    line = lines[i];
                }
            }
            //Find X and Z Offsets
            var indexX = line.indexOf("X");
            var indexZ = line.indexOf("Z");
            // Check if home value for x is e.g. 12.00 vs 9.00
            if(line.substring(indexX + 4, indexX + 5) == ' ') {
                x = line.substring(indexX + 1, indexX + 5);
            }
            else {
                x = line.substring(indexX + 1, indexX + 6);
            }
            x = parseFloat(x);
            z = line.substring(indexZ + 1, line.length);
            z = parseFloat(z);

            // Return an array containing the two offset values
            // Break case 1, home offset stored into array
            homeOffset = [x, z];
        }
        else if (tries >= 3) {
            // Return error code if break case 2 is met
            homeOffset = -1;
        }
        else {
            tries += 1;
            getHomeOffset();
        }
    }, 100);
}
// Command response handling to populate textbox field with return
socket.on('cmdResponse', function(msg) {
    var txtField = $('#cmdResponse');
    // Since board sends response in chunks, find the right chunk of data
    if(msg.indexOf('Home offset') > -1) {
        cmdResponse = msg;
    }
    // look to see if we're at the bottom of the scrolling.  If so, we'll automatically scroll in the new message later.
    var autoScroll = txtField.scrollTop - txtField.scrollHeight;
    txtField.append(msg);
    if (autoScroll == 0) {
        txtField.scrollTop = txtField.scrollHeight;
    }
});
// On page load hide connection banner so it doesn't get in the way
$(function(){
    var tab = location.hash;
    if (tab.length == 0) tab = "#linetwork";
    $(tab).click();
    $('#connectionState').hide()
});
// Listen for beta update event and prompt for password
socket.on('update-beta', function() {
    var pswd = window.prompt('Enter beta branch password');
    socket.emit('update-beta', pswd);
});

socket.on('ipAddress', function(address){
    $('#ipAddr').show();
    $('#ipAddr').html("IP Address :: " + address);
});

socket.on('localNetmask', function(mask){
    $('#wlan0netmask').show();
    $('#wlan0netmask').html("Subnet :: " + mask);
});

// Listen for zip logs from server
socket.on('zipLogs', function() {
    $('#statusMessage').html('Zipping logs. Please wait for logs to download.');
    $('#myModal').modal('show');
});

// Listen for set id event with password prompt
socket.on('setid', function(msg) {
    var pswd = window.prompt('Enter password to set printer ID. Printer will reboot automatically');
    // Let user confirm the serial number
    if(window.confirm('Serial Number will be changed to:\n' + msg + '\nOk?')) {
        alertAndReboot();
        window.location.href = '/#tabnetwork';
        socket.emit('setid', pswd);
    }
});

// Listen for set id event
socket.on('setidNP', function(msg) {
    // Let user confirm the serial number
    if(window.confirm('Serial Number will be changed to:\n' + msg + '\nOk?')) {
        alertAndReboot();
        window.location.href = '/#tabnetwork'
        socket.emit('setidNP');
    }
});

// Alert user if serial number is rejected
socket.on('invalidID', function() {
    // Invalid ID was entered
        $('#statusMessage').html('Invalid Serial Number. Please try again.');
        $('#myModal').modal('show');
});
// Alert user if password accepted
socket.on('update-success', function() {
        $('#statusMessage').html('Password Accepted. Beginning update.');
        $('#myModal').modal('show');
});
// Alert user if beta update password doesn't match
socket.on('update-failure', function() {
    $('#statusMessage').html('Error: Password is incorrect');
    $('#myModal').modal('show');
});
// Server lost banner on disconnect
socket.on('disconnect', function(msg) {
    $('#connectionState').show();
    $('#connectionState').removeClass('alert-success');
    $('#connectionState').addClass('alert-danger');
    $('#connectionState').text('Connection to the server lost...');
    $('#connectionState').addClass('in');
});
// Server lost banner on reconnect
socket.on('connect', function(msg) {
    $('#connectionState').removeClass('alert-danger');
    $('#connectionState').addClass('alert-success');
    $('#connectionState').text('Connection to the server restored...');
    refreshEverything();
    UnBlockUI();
    setTimeout(function() {
        $('#connectionState').removeClass('in');
        $('#connectionState').hide();
    }, 1000);
});
socket.on('chat message', function(msg) {
    $('#messages').append($('<li>').text(msg));
});
// Captures temperature from printer response
socket.on('temperature', function(msg) {
    $('#temperature').text(String(msg));
    temperature = String(msg);
});

// Capture the current printer type for polar box only
socket.on('currentPrinterType', function(msg) {
    $('#currentPrinterType').text(String(msg));
});

// Update status of printer
socket.on('statusUpdate', function(msg) {
    var statusStr = JSON.stringify(msg, null, 4);
    status = msg.status;

    // Keep blocking if updating
    if(status == "8") {
        BlockUI();
    }

    // Handle all cases for removing pause buttons from interface
    if (status == "0" || status == "1" || status == "6") {
        $('#jobControls').hide();
        $('#changeFilamentHide').hide();
        $('#pauseKillHide').hide();
        $('#coldPauseHide').hide();
    }
    if (status == "9") {
        $('#coldPause').html('Resume from Cold Pause');
        $('#changeFilamentHide').hide();
        $('#pauseResume').hide();
    }
    if (status == "10") {
        $('#changeFilament').html('Resume Printing');
        $('#coldPauseHide').hide();
        $('#pauseResume').hide();
    }
    if (status == "4") {
        $('#pauseResume').html('Resume');
        $('#coldPauseHide').hide();
        $('#changeFilamentHide').hide();
    }
    if (status == "3") {
        $('#pauseResume').show();
        $('#pauseResume').html('Pause');
        $('#coldPauseHide').show();
        $('#coldPause').html('Cold Pause');
        $('#changeFilamentHide').show();
        $('#changeFilament').html('Change Filament');
        $('#pauseKillHide').show();
    }
    // Parse out the information
    var statOutput = 'Printer Status: ' + msg.status + '\n';
    statOutput += 'Progress: ' + msg.progress + '\n';
    statOutput += 'Progress Detail: ' + msg.progressDetail + '\n';
    statOutput += 'Estimated Time: '+ msg.estimatedTime + '\n';
    statOutput += 'Filament Required: '+ msg.filamentUsed + '\n';
    statOutput += 'Start Time: ' + msg.startTime + '\n';
    statOutput += 'Printing For(s): ' + msg.printSeconds + '\n';
    statOutput += 'Bytes Read: ' + msg.bytesRead + '\n';
    statOutput += 'File Size: ' + msg.fileSize + '\n';
    statOutput += 'Temperature T0: ' + msg.temperature + '\n';
    statOutput += 'Temperature T1: ' + msg.temperature_2 + '\n';
    statOutput += 'Bed Temperature: ' + msg.temperature_bed + '\n';
    statOutput += 'Print Job ID: ' + msg.jobID + '\n';
    statOutput += 'Print File: ' + msg.file + '\n';
    statOutput += 'Print Config: ' + msg.config + '\n';
    statOutput += 'Security Code: ' + msg.securityCode + '\n';

    $('#status').val(statOutput);
    $('#statusCamPage').val(statOutput);
    $('#statusPrinterPage').val(statOutput);
    $('#sliceStatus').text(msg.sliceDetails);
    $('#sliceStatusPrinterPage').text(msg.sliceDetails);

});
function changeSource(theSource) {
    $("#vidSource").attr("src", 'http://' + location.host + ':8080/?action=' + theSource);
};
$(function() {
    changeSource('stream');
});
// Upload STL file submit button
$("#UploadStl").submit(function() {
    var stlFile = $("#stlFile").val();
    // Make sure a file is submitted
    if (stlFile == "") {
        $('#statusMessage').html('Please select a stl file to upload.');
        $('#myModal').modal('show');
        return false;
    }
});

// Sets polar box printer type
$("#btnSetPrinterType").click(function() {
    var type = $("#printerTypes").val();
    // Make sure a file is submitted
    if (type == "") {
        $('#statusMessage').html('Please select a printer type');
        $('#myModal').modal('show');
        return false;
    }
    $('#statusMessage').html('Printer type set to: ' + type + '. Note connection will be lost briefly before changes take effect.');
    $('#myModal').modal('show');
    socket.emit('setPrinterType', type);
});

// Submit print file
$("#PrintFile").submit(function(event) {
    var jobInfo = {};
    jobInfo.job_id = '123';
    var config = $("#configFile").val();
    if (config == "") {
        $('#statusMessage').html('Please select the print configuration');
        $('#myModal').modal('show');
        return false;
    }
    if (config.indexOf('/') == 0)
        // This is a local file so add our printer address.
        jobInfo.config_file = 'http://127.0.0.1' + config;
    else
        jobInfo.config_file = config;
    var fileStr = $("#fileName").val();
    if (fileStr == "") {
        $('#statusMessage').html('Please select the print file');
        $('#myModal').modal('show');
        return false;
    }
    jobInfo.stl_file = 'http://' + location.host + '/files/stl/' + fileStr;
    jobInfo.file_name = fileStr;
    jobInfo.isLocal = 1;
    socket.emit('printFile', jobInfo);
    event.preventDefault();
});
var whichCommand = 0;
var pastCommands = [];
// Temperature input box
$('#tempCmdSend').click(function(event) {
    var tempToSend = $('#t').val();
    if (tempToSend == "" || isNaN(tempToSend)) {
        $('#statusMessage').html('Please enter a Temperature');;
        $('#myModal').modal('show');
        $('#t').focus();
        return false;
    event.preventDefault();
    }
    // Appends user input temperature to M104 command
    socket.emit('gCode', 'M104 S' + tempToSend);
    // Turn on fan only if temp is greater than 50 C
    if (tempToSend >= 50) {
        socket.emit('gCode', 'M106 S255')
    } else if (tempToSend < 50) {
        socket.emit('gCode', 'M107')
    }
    if (pastCommands.indexOf(tempToSend) == -1) pastCommands.push(tempToSend);
    $('#t').val('');
    event.preventDefault();
});
// Send gcode command through input textbox
$('#cmdSend').click(function(event) {
    var gCodeToSend = $('#m').val().toUpperCase();
    if (gCodeToSend == "") {
        $('#statusMessage').html('Please enter a GCode Command');
        $('#myModal').modal('show');
        $('#m').focus();
        return false;
    }
    socket.emit('gCode', gCodeToSend);
    if (pastCommands.indexOf(gCodeToSend) == -1) pastCommands.push(gCodeToSend);
    $('#m').val('');
    event.preventDefault();
});
// Save commands entered in text box
$("#m").keydown(function(event) {
    if (event.which == 40) { // DOWN arrow pressed
        whichCommand--;
        if (whichCommand == 0) whichCommand = pastCommands.length;
        if (pastCommands.length) $('#m').val(pastCommands[whichCommand - 1]);
        event.preventDefault();
    }
    if (event.which == 38) { // UP arrow pressed
        whichCommand++;
        if (whichCommand > pastCommands.length) whichCommand = 1;
        if (pastCommands.length) $('#m').val(pastCommands[whichCommand - 1]);
        event.preventDefault();
    }
});
// Look for enter button press to send gcode command
$("#m").keypress(function(event) {
    if (event.which == 13) {
        $('#cmdSend').click();
        event.preventDefault();
    }
});
// Look for enter button press to send temp
$("#t").keypress(function(event) {
    if (event.which == 13) {
        $('#tempCmdSend').click();
        event.preventDefault();
    }
});
// Look for enter button press to send z axis adjustment value
$("#zCmdSend").keypress(function(event) {
    if (event.which == 13) {
        $('#zCmdSendButton').click();
        event.preventDefault();
    }
});
// Look for enter button press to send x axis adjustment value
$("#xCmdSend").keypress(function(event) {
    if (event.which == 13) {
        $('#xCmdSendButton').click();
        event.preventDefault();
    }
});
function getCheckedRadioValue(radioGroupName) {
    var rads = document.getElementsByName(radioGroupName),
        i;
    for (i = 0; i < rads.length; i++)
        if (rads[i].checked)
            return rads[i].value;
    return null; // or undefined, or your preferred default for none checked
}

// Get network status
socket.on('getNetworkStatus', function(status) {
    if (status == "1") {
        $('#lanMode').show();
        $('#wifiMode').hide();
        $('#hotspotMode').hide();
    } else if (status == "2") {
        $('#lanMode').hide();
        $('#wifiMode').show();
        $('#hotspotMode').hide();
    } else if (status == "3") {
        $('#lanMode').hide();
        $('#wifiMode').hide();
        $('#hotspotMode').show();
    }
});
// Pull STL files
socket.on('getStlFiles', function(list) {
    var listStr = JSON.stringify(list, null, 4);
    stlList = JSON.parse(listStr);
    $('#fileName').empty();
    $('#fileName').append('<option value="" selected>Select stl file...</option>').val('');
    $.each(stlList, function() {
        if (this.name != "") {
            $('#fileName').append(
                $("<option class='icon-lock'></option>").text(this.name).val(this.name)
            );
        }
    });
    $('.selectpicker').selectpicker('refresh');
});

function refreshEverything() {
    socket.emit('isPolarBox');
    socket.emit('myNetworks');
    socket.emit('myEthernet');
    socket.emit('getNetworks');
    socket.emit('getStlFiles');
    socket.emit('getVersion');
    socket.emit('getMAC');
    socket.emit('checkCamera');
    socket.emit('getNetworkStatus');
}

// Do everything :)
$(function() {
    refreshEverything();
});
// Get Mac address
socket.on('getMAC', function(msg) {
    $('#wlan0Mac').show();
    $('#wlan0Mac').html("Current MAC :: " + msg);
});
// Get version of printer
socket.on('getVersion', function(msg) {
    $('#liupdate').hide();
    $(document).prop('title', 'Polar3d -- ' + msg[0].currentVersion);
    $('#divversionnumber').html("Version :: " + msg[0].currentVersion);
    $('#divserialnumber').html(msg[0].serialNumber);
    // Go check if local button gets updated
    socket.emit('localUpdateButton');
});

// Show the update button if there is an update
socket.on('showUpdateButton', function(){
    $('#liupdate').show();
});

// Hide things if it is a polar box
socket.on('isPB', function(list){
    $('#liprint').hide();
    $('#liprinter').show();
    $('#licalibrate').hide();
    $('#hidePolarLights').hide();
    $('#setPrinterType').show();
    var listStr = JSON.stringify(list, null, 4);
    list = JSON.parse(listStr);
    $('#printerTypes').empty();
    $('#printerTypes').append('<option value="" selected>Select Printer Type</option>').val('');
    $.each(list, function() {
        if (this.name != "" && this.name != 'printer.json' && this.name.indexOf('Polar3D') == -1) {
            this.name = this.name.replace('.json', '');
            $('#printerTypes').append(
                $("<option class='icon-lock'></option>").text(this.name).val(this.name)
            );
        }
    });
    $('.selectpicker').selectpicker('refresh');
    socket.emit('getCurrentPrinter');
});

// Navigate to BlocksCAD
$('#tabdesign').click(function() {
	window.location.href="/BlocksCAD";
});


// Hide everything except printer tab
$('#tabprinter').click(function() {
    $('#divprinter').show();
    $('#liprinter').addClass("active");
    $('#liprint').removeClass("active");
    $('#divprint').hide();
    $('#divcontrols').hide();
    $('#licontrols').removeClass("active");
    $('#divcamera').hide();
    $('#licamera').removeClass("active");
    $('#licalibrate').removeClass("active");
    $('#divcalibrate').hide();
    $('#divnetwork').hide();
    $('#linetwork').removeClass("active");
});

// Hide everything except print tab
$('#tabprint').click(function() {
    $('#divprint').show();
    $('#liprint').addClass("active");
    $('#divcontrols').hide();
    $('#licontrols').removeClass("active");
    $('#divcamera').hide();
    $('#licamera').removeClass("active");
    $('#licalibrate').removeClass("active");
    $('#divcalibrate').hide();
    $('#divnetwork').hide();
    $('#linetwork').removeClass("active");
    $('#divprinter').hide();
    $('#liprinter').removeClass("active");
});

// Hide everything except controls tab
$('#tabcontrols').click(function() {
    $('#divprint').hide();
    $('#liprint').removeClass("active");
    $('#divcontrols').show();
    $('#licontrols').addClass("active");
    $('#divcamera').hide();
    $('#licamera').removeClass("active");
    $('#licalibrate').removeClass("active");
    $('#divcalibrate').hide();
    $('#divnetwork').hide();
    $('#linetwork').removeClass("active");
    $('#divprinter').hide();
    $('#liprinter').removeClass("active");
});
// Hide everything except camera tab
$('#tabcamera').click(function() {
    $('#divprint').hide();
    $('#liprint').removeClass("active");
    $('#divcontrols').hide();
    $('#licontrols').removeClass("active");
    $('#divcamera').show();
    $('#licamera').addClass("active");
    $('#licalibrate').removeClass("active");
    $('#divcalibrate').hide();
    $('#divnetwork').hide();
    $('#linetwork').removeClass("active");
    $('#divprinter').hide();
    $('#liprinter').removeClass("active");
});
// Hide everything except network tab
$('#tabnetwork').click(function() {
    $('#divprint').hide();
    $('#liprint').removeClass("active");
    $('#divcontrols').hide();
    $('#licontrols').removeClass("active");
    $('#divcamera').hide();
    $('#licamera').removeClass("active");
    $('#licalibrate').removeClass("active");
    $('#divcalibrate').hide();
    $('#divnetwork').show();
    $('#linetwork').addClass("active");
    $('#divprinter').hide();
    $('#liprinter').removeClass("active");
});
// Hide everything except calibration tab
$('#tabcalibration').click(function() {
    $('#divprint').hide();
    $('#liprint').removeClass("active");
    $('#divcontrols').hide();
    $('#licontrols').removeClass("active");
    $('#divcamera').hide();
    $('#licamera').removeClass("active");
    $('#licalibrate').addClass("active");
    $('#divcalibrate').show();
    $('#divnetwork').hide();
    $('#linetwork').removeClass("active");
    $('#divprinter').hide();
    $('#liprinter').removeClass("active");
});
// Alert for reboot
function alertAndReboot() {
    $('#statusMessage').html("The printer is now rebooting, this screen will refresh automatically in 90 seconds");
    $('#myModal').modal('show');
    setTimeout(function() {
        window.location.reload(true)
    }, 90000);
}
// Try to connect again
function tryAgain() {
    setTimeout(function() {
        if (!socket['connected']) {
            alertAndReboot();
        } else {
            tryAgain();
        }
    }, 1000);
}
// Update button confirmation
$('#tabupdate').click(function() {
    socket.emit('getReleaseNotes');
});
// Restart button confirmation
$('#tabrestart').click(function() {
    $('#statusMessageConfirm').html("Are you sure you want to restart the printer?");
    $('#myModalConfirm').modal('show');
    $('#hidConfirm').val('1');
});
// Reset printer confirmation
$('#resetPrinter').click(function() {
    $('#statusMessageConfirm').html("By clicking 'Confirm', you will disconnect the printer name on the polar" +
        " cloud from this physical printer. You will still be able to access that printer name on the " +
        "polar cloud in order to view history. But you will no longer be able to control this physical " +
        "printer using that printer name on the polar cloud. <br/><br/>Note that this action is not common. It is " +
        "used primarily when you have lost access to the printer from the polar cloud, or when the " +
        "physical printer is transferred to a new owner. <br/> Do you wish to proceed?");
    $('#myModalConfirm').modal('show');
    $('#hidConfirm').val('4');
});
// Confirm restart, update, or delete network profile
$('#btnConfirm').click(function() {
    var action = $('#hidConfirm').val();
    if (action == "1") {
        socket.emit('restart');
    }
    else if (action == "2") {
        BlockUI();
        socket.emit('runUpdateScript');
    }
    else if (action == "3") {
        socket.emit('deleteNetworkProfile', {
            ssid: deleteSSID.replace("network", "")
        });
    }
    else if (action == "4") {
        socket.emit('resetPrinter');
    }
});
// Run update script
socket.on('runUpdateScript', function() {
    $('#statusMessage').html("The printer will be restarting.")
    $('#myModal').modal('show');
    UnBlockUI();
    socket.emit('reStart');
});
function sortData(data) {
    var sorted = [];
    Object.keys(data).sort(function(a, b) {
        return (data[a].quality > data[b].quality ? -1 : 1);
    }).forEach(function(key) {
        sorted.push(data[key]);
    });
    return sorted;
}

// Reset printer on cloud
socket.on('resetPrinter', function(response) {
    $('#statusMessage').html(response.message);
    $('#myModal').modal('show');
});
// Dunno what this does
socket.on('disablePrintFileUI', function() {
    $("#btnPrintFile").attr('disabled', 'disabled');
});
// Dunno what this does
socket.on('enablePrintFileUI', function() {
    $("#btnPrintFile").removeAttr('disabled');
});
        </script>
        <!-- Add div for server lost banner at bottom of page -->
        <div class="alert alert-danger fade" role="alert" id="connectionState">Connection to the server lost...</div>
    </body>
</html>
